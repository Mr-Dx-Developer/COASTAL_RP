import{al as Ce,aq as O,r as m,j as s,a as e,c0 as De,h as Re,p as L,O as we,m as ye,L as h,d as $,a4 as ee,co as ke,aW as xe,u as q,E as Le,P as Y,F as U,I as _e,f as Oe,cp as oe,bP as ie,C as B,b as re,az as Se,as as Te,q as Z,s as G,H as Ve,$ as Me,cq as Fe,a8 as Ne,a3 as de,ab as $e,ac as be,aR as We,cr as He,N as Ue,aj as Be,w as Ge,ao as Ye,bb as me,bh as ze}from"./index-5ca133d9.js";var je=function(a){return new Promise(function(r){setTimeout(r,a)})};const pe=Ce(je),x={snapBackDuration:300,maxTilt:5,bouncePower:.1,swipeThreshold:100},qe=t=>{const a=window.getComputedStyle(t),r=a.getPropertyValue("width"),u=Number(r.split("px")[0]),P=a.getPropertyValue("height"),w=Number(P.split("px")[0]);return{x:u,y:w}},Ee=(t,a)=>Math.sqrt(Math.pow(t,2)+Math.pow(a,2)),Ke=(t,a=1)=>{const r=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2));return{x:t.x*a/r,y:t.y*a/r}},he=async(t,a,r=!1)=>{const u=le(t),P=qe(document.body),w=Ee(P.x,P.y),n=Ee(a.x,a.y),v=w/n,l=w/n,E=fe(a.x*l+u.x,-a.y*l+u.y);let d="";const c=200;r?t.style.transition="ease "+v+"s":t.style.transition="ease-out "+v+"s",J(t)===0?d=X((Math.random()-.5)*c):J(t)>0?d=X(Math.random()*c/2+J(t)):d=X((Math.random()-1)*c/2+J(t)),t.style.transform=E+d,await pe(v*1e3)},Pe=async t=>{t.style.transition=x.snapBackDuration+"ms";const a=le(t),r=fe(a.x*-x.bouncePower,a.y*-x.bouncePower),u=X(J(t)*-x.bouncePower);t.style.transform=r+u,await pe(x.snapBackDuration*.75),t.style.transform="none",await pe(x.snapBackDuration),t.style.transition="10ms"},Ie=t=>{if(Math.abs(t.x)>Math.abs(t.y)){if(t.x>x.swipeThreshold)return"right";if(t.x<-x.swipeThreshold)return"left"}else{if(t.y>x.swipeThreshold)return"up";if(t.y<-x.swipeThreshold)return"down"}return"none"},Ae=(t,a)=>{const r=a.x-t.x,u=t.y-a.y,P=(a.time-t.time)/1e3;return{x:r/P,y:u/P}},fe=(t,a)=>"translate("+t+"px)",X=t=>"rotate("+t+"deg)",le=t=>{const a=window.getComputedStyle(t),r=new DOMMatrix(a.transform);return{x:r.m41,y:-r.m42}},J=t=>{const a=window.getComputedStyle(t),r=new DOMMatrix(a.transform);return-Math.asin(r.m21)/(2*Math.PI)*360},Je=(t,a,r,u)=>{const P={x:t.x+r.x,y:t.y+r.y},w={x:P.x,y:P.y,time:new Date().getTime()},n=fe(P.x),v=Ae(u,w).x/1e3,l=X(v*x.maxTilt);return a.style.transform=n+l,w},ue=t=>{const a=t.targetTouches[0];return{x:a.clientX,y:a.clientY}},ge=t=>({x:t.clientX,y:t.clientY}),Xe=O.forwardRef(({flickOnSwipe:t=!0,children:a,onSwipe:r,onCardLeftScreen:u,className:P,preventSwipe:w=[],swipeRequirementType:n="velocity",swipeThreshold:v=x.swipeThreshold,onSwipeRequirementFulfilled:l,onSwipeRequirementUnfulfilled:E},d)=>{x.swipeThreshold=v;const c=O.useRef(!1),g=O.useRef();O.useImperativeHandle(d,()=>({async swipe(S="right"){r&&r(S);const y=1e3,f=(Math.random()-.5)*100;S==="right"?await he(g.current,{x:y,y:f},!0):S==="left"&&await he(g.current,{x:-y,y:f},!0),g.current.style.display="none",u&&u(S)},async restoreCard(){g.current.style.display="block",await Pe(g.current)}}));const o=O.useCallback(async(S,y)=>{if(c.current)return;c.current=!0;const f=le(S),p=Ie(n==="velocity"?y:f);if(p!=="none"&&(r&&r(p),t&&!w.includes(p))){const M=n==="velocity"?y:Ke(f,600);await he(S,M),S.style.display="none",u&&u(p);return}Pe(S)},[c,t,r,u,w,n]),I=O.useCallback(()=>{c.current=!1},[c]);return O.useLayoutEffect(()=>{let S={x:null,y:null},y={x:0,y:0},f={x:0,y:0,time:new Date().getTime()},p=!1,M="none";g.current.addEventListener("touchstart",N=>{N.preventDefault(),I(),S={x:-ue(N).x,y:-ue(N).y}}),g.current.addEventListener("mousedown",N=>{N.preventDefault(),p=!0,I(),S={x:-ge(N).x,y:-ge(N).y}});const D=N=>{if(l||E){const i=Ie(n==="velocity"?y:le(g.current));i!==M&&(M=i,M==="none"?E&&E():l&&l(i))}const A=Je(N,g.current,S,f);y=Ae(f,A),f=A};g.current.addEventListener("touchmove",N=>{N.preventDefault(),D(ue(N))}),g.current.addEventListener("mousemove",N=>{N.preventDefault(),p&&D(ge(N))}),g.current.addEventListener("touchend",N=>{N.preventDefault(),o(g.current,y)}),g.current.addEventListener("mouseup",N=>{p&&(N.preventDefault(),p=!1,o(g.current,y))}),g.current.addEventListener("mouseleave",N=>{p&&(N.preventDefault(),p=!1,o(g.current,y))})},[]),O.createElement("div",{ref:g,className:P},a)});function ve(){const{View:t}=m.useContext(z),[a,r]=t;return s("div",{className:"home-header",children:[e(De,{onClick:()=>r("profile")}),e("img",{className:"logo",src:"./assets/img/icons/tinder/logo.svg",onClick:()=>r("home")}),e(Re,{onClick:()=>r("messageList")})]})}const W={account:{name:"James",bio:"I'm a cool guy",dob:9624888e5,photos:["https://r2.fivemanage.com/images/GRBUI6C4orbD.webp","https://r2.fivemanage.com/images/98avzSwlgzsg.webp","https://r2.fivemanage.com/images/rafgjPwSYnn2.png"],showMen:!1,showWomen:!0,isMale:!0,active:!0},accounts:[{number:"1",dob:9653888e5,name:"Jessica",bio:"Swipe right if you like dogs",photos:["https://r2.fivemanage.com/images/oRKcdeTA8oBy.png"],isMale:!1,matched:!0},{number:"2",dob:9653888e5,name:"Klara",bio:"Member of Lost MC, looking for a good time",photos:["https://r2.fivemanage.com/images/787FMzhn5xD5.png","https://r2.fivemanage.com/images/ZsmnyJOA2rc5.png"],isMale:!1,liked:!0},{number:"3",dob:9653888e5,name:"Steph",bio:"Evening strolls are my thing",photos:["https://r2.fivemanage.com/images/7zj3Xgy6FsXK.png"],matched:!0,isMale:!1,lastMessage:"I'm perfect, you look good!"}],messages:{3:[{sender:"1",content:"Im perfect, you look good!",timestamp:Date.now()-1e3*60*60*24*1},{sender:"1234567890",content:"I'm good, how about you?",timestamp:Date.now()-1e3*60*60*24*2},{sender:"1",content:"Hey, how are you?",timestamp:Date.now()-1e3*60*60*24*3}]}};function Ze(){const{View:t,User:a,Account:r}=m.useContext(z),[u,P]=t,[w,n]=a,[v,l]=r,[E,d]=m.useState([]),[c,g]=m.useState(0),[o,I]=m.useState(),S=m.useRef(c),y=m.useRef(0),[f,p]=m.useState([]),[M,D]=m.useState(0),[N,A]=m.useState(!1),[i,T]=m.useState(null);let[R,V]=m.useState("");m.useEffect(()=>{L("Tinder",{action:"getFeed",page:0},W.accounts.filter(b=>!b.matched)).then(b=>{b&&b.length>0?(d(b),g(b.length-1),y.current=b.length,p(Array(b.length).fill(0).map(C=>O.createRef()))):A(!0)})},[]);const H=b=>{g(b),S.current=b},j=c<E.length-1,te=c>=0,se=(b,C,_)=>{I(b),H(_-1),F(),b==="right"?L("Tinder",{action:"swipe",like:!0,number:C.number},W.accounts.find(ne=>ne.liked&&ne.number==C.number)).then(ne=>{ne&&T(C)}):b==="left"&&L("Tinder",{action:"swipe",like:!1,number:C.number})},ae=(b,C)=>{S.current>=C&&f[C].current.restoreCard()},K=async b=>{te&&c<E.length&&(await f[c].current.swipe(b),F())},k=async()=>{var C,_;if(!j)return;const b=c+1;H(b),await((_=(C=f[b])==null?void 0:C.current)==null?void 0:_.restoreCard())},F=()=>{if(y.current>1){y.current=y.current-1;return}L("Tinder",{action:"getFeed",page:M+1}).then(b=>{if(b)if(b&&b.length>0){D(M+1);let C=b.length+E.length;d(_=>(_=[..._,...b],_)),y.current=b.length,g(C-1),p(Array(C).fill(0).map(_=>O.createRef()))}else A(!0)})};return s("div",{className:`home-wrapper slide ${u=="profile"?"left":"right"}`,children:[e(ve,{}),e(we,{children:i&&s(ye.div,{initial:{opacity:0,scale:.1},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.1},transition:{duration:.3,ease:"easeInOut"},className:"match",style:{backgroundImage:`url(${i.photos[0]})`},children:[e("img",{className:"match-image",src:"./assets/img/icons/tinder/match.png"}),s("div",{className:"likes-too",children:[i.name," ",h("APPS.TINDER.LIKES_YOU_TOO").toLowerCase()]}),s("div",{className:"input",children:[e($,{type:"text",placeholder:h("APPS.TINDER.SAY_SOMETHING_NICE"),onChange:b=>V(b.target.value)}),e("div",{className:"send",onClick:()=>{L("Tinder",{action:"sendMessage",data:{recipient:i.number,content:R}},!0).then(b=>{b&&(n(i),P("message"))})},children:h("APPS.TINDER.SEND")})]}),e("div",{className:"keep-swiping",onClick:()=>T(null),children:h("APPS.TINDER.KEEP_SWIPING")})]})}),s("div",{className:"home-body",children:[s("div",{className:"cards",children:[N&&e("div",{className:"card no-more",children:e("div",{children:h("APPS.TINDER.NO_MORE")})}),!v.active&&e("div",{className:"card no-more",children:e("div",{children:h("APPS.TINDER.HIDDEN_PROFILE")})}),v.active&&E.map((b,C)=>e(Xe,{ref:f[C],className:"swipe",onSwipe:_=>se(_,b,C),onCardLeftScreen:()=>ae(b,C),children:e(Qe,{user:b})},C))]}),s("div",{className:"actions",children:[e("div",{className:"button",onClick:()=>K("left"),children:e(ee,{style:{color:"#F24C65"}})}),e("div",{className:`button small ${j?"":"disabled"}`,onClick:()=>k(),children:e(ke,{style:{rotate:"180deg",color:"#F2B721"}})}),e("div",{className:"button",onClick:()=>K("right"),children:e(xe,{style:{color:"#3CDBA7"}})})]})]})]})}const Qe=t=>{let a=t.user;const[r,u]=m.useState(0),[P,w]=m.useState(0);return m.useEffect(()=>{w(Q(a.dob))},[a]),s("div",{className:"card",style:{backgroundImage:`url(${a.photos[r]})`},onClick:n=>{r<a.photos.length-1?u(r+1):u(0)},children:[a.photos.length>1&&e("div",{className:"image-count",children:a.photos.map((n,v)=>e("div",{className:`image ${v==r?"active":""}`,onClick:l=>{l.stopPropagation(),u(v)}}))}),s("div",{className:"card-content",children:[s("div",{className:"name",children:[a.name," ",e("span",{children:P})]}),e("div",{className:"description",children:a.bio})]})]})};function et(){const{LoggedIn:t,Account:a}=m.useContext(z),r=q(Y.PhoneNumber),[u,P]=a,[w,n]=t,[v,l]=m.useState("notLoggedIn"),[E,d]=m.useState(0),[c,g]=m.useState({});m.useEffect(()=>{Le("Tinder")&&(v=="notLoggedIn"?Y.Styles.TextColor.set("#ffffff"):Y.Styles.TextColor.set("#000000"))},[v]);const[o,I]=m.useState({name:null,photos:[],_dob:{day:"",month:"",year:""},dob:null,bio:null,showMen:!1,showWomen:!1,isMale:null}),S=f=>{var p,M,D;switch(f){case 0:let N=new Date(`${(p=o._dob)==null?void 0:p.year}/${(M=o._dob)==null?void 0:M.month}/${(D=o._dob)==null?void 0:D.day}`);if(y(N)){let A=Q(N);o.name&&o.name.length>=2&&A>=18&&A<=100&&(I({...o,dob:N.getTime()}),d(f+1))}break;case 1:o.photos.length>0&&d(f+1);break;case 2:o.bio&&o.bio.length>=10&&d(f+1);break;case 3:(o.showMen||o.showWomen)&&d(f+1);break;case 4:(o.isMale==!0||o.isMale==!1)&&L("Tinder",{action:"createAccount",data:{...o,dob:new Date(o.dob).toISOString().split("T")[0]}},!0).then(A=>{if(!A)return Z("error","Failed to create account");G.APPS.TINDER.account.set(o),P(o),n(!0)});break}},y=f=>f.getTime()===f.getTime();return e("div",{className:"login-container",style:{background:v==="notLoggedIn"?"linear-gradient(45deg, #626fbf, #952fe5)":"#ffffff"},children:v==="notLoggedIn"?s(U,{children:[s("div",{className:"logo",children:[e("img",{src:"./assets/img/icons/tinder/logo-white.svg"}),e("div",{className:"logo-text",children:h("APPS.TINDER.TITLE").toLowerCase()})]}),s("div",{className:"buttons",children:[e("div",{className:"disclamer",children:h("APPS.TINDER.AGREE_TERMS")}),e("div",{className:"button create",onClick:()=>{l("createAccount")},children:h("APPS.TINDER.CREATE_ACCOUNT")})]})]}):s("div",{className:"create-account",children:[e(_e,{className:"chevron",onClick:()=>{E>0?d(E-1):l("notLoggedIn")}}),E==0&&s(U,{children:[e("div",{className:"title",children:h("APPS.TINDER.CREATE_ACCOUNT")}),s("div",{className:"form-body",children:[e($,{defaultValue:Oe(r),type:"text",disabled:!0}),e($,{placeholder:"Name",type:"text",maxLength:25,onChange:f=>{I({...o,name:f.target.value}),f.target.value.length>=3?g({...c,name:!0}):g({...c,name:!1})}}),s("div",{className:"dob",children:[s("div",{className:"inputs",children:[e($,{placeholder:"MM",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:2,maxLength:2,onChange:f=>{I({...o,_dob:{...o._dob,month:f.target.value}})}}),e("span",{children:"/"}),e($,{placeholder:"DD",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:2,maxLength:2,onChange:f=>{I({...o,_dob:{...o._dob,day:f.target.value}})}}),e("span",{children:"/"}),e($,{placeholder:"YYYY",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:4,maxLength:4,onChange:f=>{var N,A,i;let p={...o,_dob:{...o._dob,year:f.target.value}};I(p);let M=new Date(`${(N=p._dob)==null?void 0:N.year}/${(A=p._dob)==null?void 0:A.month}/${(i=p._dob)==null?void 0:i.day}`),D=Q(M);D>=18&&D<100?g({...c,18:!0}):g({...c,18:!1})}})]}),e("div",{className:"disclamer",children:h("APPS.TINDER.AGE_PUBLIC")}),s("div",{className:"requirement",children:[c[18]?e(oe,{className:"green"}):e(ie,{className:"red"}),h("APPS.TINDER.BE_OVER_18")]}),s("div",{className:"requirement",children:[c.name?e(oe,{className:"green"}):e(ie,{className:"red"}),h("APPS.TINDER.NAME_MINIMUM")]})]})]})]}),E==1&&s(U,{children:[e("div",{className:"title",children:h("APPS.TINDER.ADD_PHOTOS")}),e("div",{className:"photo-grid",children:[...Array(6)].map((f,p)=>{var D;let M=((D=o.photos)==null?void 0:D[p-1])||p==0;return o.photos[p]?e("div",{className:"photo",style:{backgroundImage:`url(${o.photos[p]})`},children:e("div",{className:"button remove",onClick:()=>{let N=o.photos;N.splice(p,1),I({...o,photos:N}),N.length==0&&g({...c,photos:!1})},children:e(ee,{})})}):e("div",{className:"photo",children:M&&e("div",{className:"button add",onClick:()=>{var N,A,i;B.Gallery.set({allowExternal:(i=(A=(N=re)==null?void 0:N.value)==null?void 0:A.AllowExternal)==null?void 0:i.Tinder,onSelect:T=>I({...o,photos:[...o.photos,T.src]})}),g({...c,photos:!0})},children:e(Se,{})})})})}),s("div",{className:"requirement",children:[c.photos?e(oe,{className:"green"}):e(ie,{className:"red"}),h("APPS.TINDER.PHOTOS_MINIMUM")]})]}),E==2&&s(U,{children:[e("div",{className:"title",children:h("APPS.TINDER.DESCRIPTION")}),e(Te,{placeholder:"Description",maxLength:200,onChange:f=>{I({...o,bio:f.target.value}),f.target.value.length>=10?g({...c,bio:!0}):g({...c,bio:!1})}}),s("div",{className:"requirement",children:[c.bio?e(oe,{className:"green"}):e(ie,{className:"red"}),h("APPS.TINDER.DESCRIPTION_MINIMUM")]})]}),E==3&&s(U,{children:[e("div",{className:"title",children:h("APPS.TINDER.SHOW_ME")}),s("div",{className:"showme",children:[e("div",{className:`button border ${o.showWomen&&!o.showMen?"active":""}`,onClick:()=>{I({...o,showMen:!1,showWomen:!0})},children:h("APPS.TINDER.WOMEN")}),e("div",{className:`button border ${o.showMen&&!o.showWomen?"active":""}`,onClick:()=>{I({...o,showMen:!0,showWomen:!1})},children:h("APPS.TINDER.MEN")}),e("div",{className:`button border ${o.showMen&&o.showWomen?"active":""}`,onClick:()=>{I({...o,showMen:!0,showWomen:!0})},children:h("APPS.TINDER.EVERYONE")})]})]}),E==4&&s(U,{children:[e("div",{className:"title",children:h("APPS.TINDER.I_AM")}),s("div",{className:"showme",children:[e("div",{className:`button border ${o.isMale===!0?"active":""}`,onClick:()=>{I({...o,isMale:!0})},children:h("APPS.TINDER.MALE")}),e("div",{className:`button border ${o.isMale===!1?"active":""}`,onClick:()=>{I({...o,isMale:!1})},children:h("APPS.TINDER.FEMALE")})]})]}),e("div",{className:"button gradient",onClick:()=>S(E),children:h("APPS.TINDER.CONTINUE")})]})})}const ce=Ve(null);function tt(){var A;const{View:t,User:a}=m.useContext(z);q(Y.Settings);const r=q(Y.PhoneNumber),[u,P]=a,[w,n]=t,v=q(ce),[l,E]=m.useState([]),[d,c]=m.useState(0),[g,o]=m.useState(!1),[I,S]=m.useState(!1),y=m.useRef(null),f=m.useRef(0),[p,M]=m.useState({content:"",attachments:[]});m.useEffect(()=>{L("Tinder",{action:"getMessages",page:0,number:u.number},W.messages[u.number]).then(i=>{i&&i.length>0?E(i.reverse()):o(!0)})},[]);const D=()=>{if(p.content.length===0&&p.attachments.length===0)return;const i={sender:r,recipient:u.number,content:p.content,attachments:p.attachments,timestamp:new Date().getTime()};L("Tinder",{action:"sendMessage",data:i},!0).then(T=>{if(!T)return Z("error","Failed to send message");y.current.value="",M({content:"",attachments:[]}),E([...l,i])})},N=()=>{if(g||I)return;let i=document.querySelector("#last");if(!i)return;!Ue(i)&&(S(!0),L("Tinder",{action:"getMessages",page:d+1,number:u.number},null).then(R=>{if(R&&R.length>0){let V=document.querySelector(".message-container");f.current=V.scrollHeight,E([...R.reverse(),...l]),S(!1)}else o(!0)}),c(R=>R+1))};return m.useEffect(()=>{let i=document.querySelector(".message-container");const T=i.scrollHeight;i.scrollTop+=T-f.current,i.scroll},[l]),Me("tinder:newMessage",i=>{u.number===i.sender&&E([...l,i])}),s("div",{className:"home-wrapper slide left",children:[e(we,{children:v&&e(st,{})}),s("div",{className:"message-header",children:[e(Fe,{onClick:()=>{n("messageList"),P(null)}}),s("div",{className:"user",onClick:()=>ce.set(u),children:[e("img",{className:"profile-picture",src:(A=u.photos)==null?void 0:A[0]}),e("div",{className:"name",children:u.name})]})]}),e("div",{className:"message-container",onScroll:N,children:e("div",{className:"message-body",children:l.map((i,T)=>{var te,se,ae,K;let R,V=T===0?"last":"",H=i.sender===r?"self":"other",j=((te=l[T+1])==null?void 0:te.sender)===r?"self":"other";return l[T+1]?R=Math.abs(i.timestamp-l[T+1].timestamp)/36e5:j=void 0,s("div",{className:`message ${H}`,id:V,children:[H=="other"?s("div",{className:"message-with-pfp",children:[e("div",{className:`profile-picture ${H!==j?"show":"hide"}`,children:e("img",{src:(se=u.photos)==null?void 0:se[0]})}),s("div",{className:"message-content",children:[i.content&&e("div",{className:"content",children:Ne(i.content)}),((ae=i.attachments)==null?void 0:ae.length)>0&&e("div",{className:"attatchments",children:i.attachments.map((k,F)=>de(k)?e("video",{src:k,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:b=>{B.FullscreenImage.set({display:!0,image:k})}},F):e($e,{src:k,onClick:()=>{B.FullscreenImage.set({display:!0,image:k})}},F))})]})]}):s(U,{children:[i.content&&e("div",{className:"content",children:Ne(i.content)}),((K=i.attachments)==null?void 0:K.length)>0&&e("div",{className:"attatchments",children:i.attachments.map((k,F)=>de(k)?e("video",{src:k,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:()=>{B.FullscreenImage.set({display:!0,image:k})}},F):e("img",{src:k,onClick:()=>{B.FullscreenImage.set({display:!0,image:k})}},F))})]}),l[T+1]&&R>6?e("div",{className:"date",children:be(i.timestamp)}):H!==j&&e("div",{className:"date",children:be(i.timestamp)})]},T)})})}),e("div",{className:"attachments",children:p.attachments.map((i,T)=>s("div",{className:"attachment",children:[de(i)?e("video",{src:i,controls:!1,muted:!0,loop:!0,autoPlay:!0}):e("img",{src:i}),e(ee,{onClick:()=>{M({...p,attachments:p.attachments.filter((R,V)=>V!==T)})}})]}))}),s("div",{className:"message-bottom",children:[e(We,{className:"image",onClick:()=>{var i,T,R;p.attachments.length<3&&B.Gallery.set({includeVideos:!0,allowExternal:(R=(T=(i=re)==null?void 0:i.value)==null?void 0:T.AllowExternal)==null?void 0:R.Messages,onSelect:V=>M({...p,attachments:[...p.attachments,V.src]})})}}),s("div",{className:"input",children:[e($,{type:"text",placeholder:"Type a message...",ref:y,onChange:i=>{M({...p,content:i.target.value})},onKeyDown:i=>{i.key==="Enter"&&D()}}),e(He,{className:p.attachments.length>0||p.content.length>0?"active":"",onClick:()=>D()})]})]})]})}const st=()=>{const t=q(ce),[a,r]=m.useState(0);return t?s(ye.div,{initial:{opacity:0,y:500},animate:{opacity:1,y:0},exit:{opacity:0,y:500},className:"popup-profile-container",children:[s("div",{className:"gallery",children:[e("img",{src:t==null?void 0:t.photos[a],onClick:()=>{t&&r(a<(t==null?void 0:t.photos.length)-1?a+1:0)}}),(t==null?void 0:t.photos.length)>1&&e("div",{className:"image-count",children:t==null?void 0:t.photos.map((u,P)=>e("div",{className:Be("image",P==a&&"active"),onClick:w=>{w.stopPropagation(),r(P)}}))}),e("div",{className:"close",onClick:()=>ce.set(null),children:e(ee,{})})]}),s("div",{className:"card-content",children:[s("div",{className:"name",children:[t==null?void 0:t.name,", ",e("span",{children:Q(t==null?void 0:t.dob)})]}),e("div",{className:"divider"}),s("div",{className:"description",children:[e("div",{className:"title",children:"About Me"}),t==null?void 0:t.bio]})]})]}):null};function at(){const{View:t,User:a}=m.useContext(z),[r,u]=a,[P,w]=t,[n,v]=m.useState({newMatches:[],messages:[]});return m.useEffect(()=>{Y.Styles.TextColor.set("#000000"),L("Tinder",{action:"getMatches"},{newMatches:W.accounts.filter(l=>l.matched&&!W.messages[l.number]),messages:W.accounts.filter(l=>W.messages[l.number])}).then(l=>{if(!l)return Z("warning","No response received from Tinder getMatches");v(l)})},[]),Me("tinder:newMessage",l=>{let E=l.sender,d=JSON.parse(JSON.stringify(n)),c=d.messages.findIndex(g=>g.number===E);if(c!==-1)d.messages.unshift(d.messages.splice(c,1)[0]);else if(c=d.newMatches.findIndex(g=>g.number===E),c!==-1)d.messages.unshift(d.newMatches.splice(c,1)[0]);else return;d.messages[0].lastMessage=l.content,v(d)}),s("div",{className:"home-wrapper slide left",children:[e(ve,{}),e(Ge,{placeholder:h("APPS.TINDER.SEARCH_MATCHES"),onChange:()=>{}})," ",s("div",{className:"message-list-body",children:[s("div",{className:"new-matches",children:[s("div",{className:"title",children:[h("APPS.TINDER.NEW_MATCHES"),n.newMatches.length>0&&e("span",{children:n.newMatches.length})]}),e("div",{className:"matches",children:n.newMatches.map((l,E)=>{var d;return s("div",{className:"new-match",onClick:()=>{u(l),w("message")},children:[e("img",{className:"profile-picture",src:(d=l.photos)==null?void 0:d[0]}),e("div",{className:"name",children:l.name})]},E)})})]}),s("div",{className:"recent-messages",children:[e("div",{className:"title",children:h("APPS.TINDER.MESSAGES")}),e("div",{className:"messages",children:n.messages.map((l,E)=>{var d,c;return((d=l.lastMessage)==null?void 0:d.length)===0&&(l.lastMessage=h("APPS.MESSAGES.SENT_A_PHOTO")),s("div",{className:"message",onClick:()=>{u(l),w("message")},children:[e("img",{className:"profile-picture",src:(c=l.photos)==null?void 0:c[0]}),s("div",{className:"user",children:[e("div",{className:"name",children:l.name}),e("div",{className:"message",children:l.lastMessage.length>40?l.lastMessage.substring(0,40)+"...":l.lastMessage})]})]},E)})})]})]})]})}function nt(){var l,E;const{Account:t,LoggedIn:a}=m.useContext(z),[r,u]=a,[P,w]=t,[n,v]=m.useState(P);return s("div",{className:"home-wrapper slide right",style:{backgroundColor:"#F6F6F6"},children:[e(ve,{}),s("div",{className:"profile-body",children:[s("div",{className:"user",children:[e("img",{className:"profile-picture",src:n.photos[0]}),s("div",{className:"name",children:[n.name,", ",Q(n.dob)]})]}),s("div",{className:"inputs",children:[s("div",{className:"input",children:[e("div",{className:"label",children:h("APPS.TINDER.NAME")}),e($,{type:"text",defaultValue:n.name,maxLength:10,onChange:d=>{v({...n,name:d.target.value})}})]}),s("div",{className:"input center",children:[e("div",{className:"label",children:h("APPS.TINDER.PHOTOS")}),e("div",{className:"photo-grid",children:[...Array(6)].map((d,c)=>{var o;let g=((o=n.photos)==null?void 0:o[c-1])||c==0;return n.photos[c]?e("div",{className:"photo",style:{backgroundImage:`url(${n.photos[c]})`},children:e("div",{className:"photo-button remove",onClick:()=>{let I=n.photos;I.splice(c,1),v({...n,photos:I})},children:e(ee,{})})},c):e("div",{className:"photo",children:g&&e("div",{className:"photo-button add",onClick:()=>{var I,S,y;B.Gallery.set({allowExternal:(y=(S=(I=re)==null?void 0:I.value)==null?void 0:S.AllowExternal)==null?void 0:y.Tinder,onSelect:f=>v({...n,photos:[...n.photos,f.src]})})},children:e(Se,{})})})})})]}),s("div",{className:"input",children:[e("div",{className:"label",children:h("APPS.TINDER.ABOUT_ME")}),e(Te,{type:"text",defaultValue:n.bio,maxLength:100,onChange:d=>{v({...n,bio:d.target.value})}})]}),s("div",{className:"input",children:[e("div",{className:"label",children:h("APPS.TINDER.INTERESTED_IN")}),s("select",{value:n.showMen&&n.showWomen?"Everyone":n.showMen?"Men":"Women",onChange:d=>{switch(d.target.value){case"Everyone":v({...n,showMen:!0,showWomen:!0});break;case"Men":v({...n,showMen:!0,showWomen:!1});break;case"Women":v({...n,showMen:!1,showWomen:!0});break}},children:[e("option",{value:"Men",children:h("APPS.TINDER.MEN")}),e("option",{value:"Women",children:h("APPS.TINDER.WOMEN")}),e("option",{value:"Everyone",children:h("APPS.TINDER.EVERYONE")})]})]}),s("div",{className:"input",children:[e("div",{className:"label",children:h("APPS.TINDER.GENDER")}),s("select",{value:n.isMale?"male":"female",onChange:d=>{d.target.value=="male"?v({...n,isMale:!0}):v({...n,isMale:!1})},children:[e("option",{value:"male",children:h("APPS.TINDER.MALE")}),e("option",{value:"female",children:h("APPS.TINDER.FEMALE")})]})]}),s("div",{className:"input",children:[e("div",{className:"label",children:h("APPS.TINDER.VISIBILITY")}),s("select",{value:n.active?"visible":"hidden",onChange:d=>{let c=d.target.value;v({...n,active:c==="visible"})},children:[e("option",{value:"visible",children:h("APPS.TINDER.VISIBLE")}),e("option",{value:"hidden",children:h("APPS.TINDER.HIDDEN")})]}),!n.active&&e("div",{className:"warning",children:h("APPS.TINDER.HIDDEN_WARNING")})]})]}),((E=(l=re)==null?void 0:l.value)==null?void 0:E.DeleteAccount.Spark)&&e("div",{className:"button red",onClick:()=>{Ye("Tinder",()=>{w(null),u(!1)},!0)},children:h("APPS.TINDER.DELETE_ACCOUNT")}),e("div",{className:"button gradient",onClick:()=>{n.name.length>=2&&n.bio.length>=5&&n.photos.length>=1?L("Tinder",{action:"saveProfile",data:n},!0).then(d=>{if(!d)return Z("error","Issue saving tinder profile");G.APPS.TINDER.account.set(n),w(n)}):Z("error","Issue saving tinder profile, (name not 2 characters, bio not over 5 or no photos)")},children:h("APPS.TINDER.SAVE")})]})]})}const z=m.createContext(null);function it(){const t=q(Y.Settings),[a,r]=m.useState(!1),[u,P]=m.useState(null),[w,n]=m.useState(null),[v,l]=m.useState("home"),[E,d]=m.useState(!0),c={home:e(Ze,{}),profile:e(nt,{}),messageList:e(at,{}),message:e(tt,{})};return m.useEffect(()=>{if(G.APPS.TINDER.account.value){P(G.APPS.TINDER.account.value),r(!0),d(!1);return}else if(G.APPS.TINDER.account.value===!1)return d(!1);L("Tinder",{action:"isLoggedIn"},W.account).then(g=>{g?(P(g),r(!0),G.APPS.TINDER.account.set(g)):G.APPS.TINDER.account.set(!1),d(!1)})},[]),m.useEffect(()=>(v==="message"?me.ReceiveAppNotifications.set(!1):me.ReceiveAppNotifications.set(!0),()=>{me.ReceiveAppNotifications.set(!0)}),[v]),e("div",{className:"tinder-container",children:e(z.Provider,{value:{LoggedIn:[a,r],Account:[u,P],User:[w,n],View:[v,l]},children:E||t!=null&&t.airplaneMode?e("div",{className:"loading",children:e(ze,{size:40,lineWeight:5,speed:2,color:"#000000"})}):a?c[v]:e(et,{})})})}function Q(t){var a=+new Date(t);return~~((Date.now()-a)/315576e5)}export{z as TinderContext,it as default,Q as getAge};
